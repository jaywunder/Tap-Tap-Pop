{"version":3,"sources":["../js/main.js"],"names":[],"mappings":"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","file":"main.js","sourcesContent":["//jshint -W117\n//jshint -W097\n'use strict';\n\nwindow.GAMERUNNING = true\nwindow.AIPLAYING = false\nwindow.AIWORKER = null\n\n// Make an instance of two and place it on the page.\nlet elem = document.getElementById('draw-shapes')\nlet params = { width: window.innerWidth, height: window.innerHeight }\nlet two = new Two(params).appendTo(elem)\n\nlet centerRadius = two.height / 8\nlet centerX = two.width / 2\nlet centerY = two.height / 2\n\n// http://stackoverflow.com/a/10364620\nlet isMobile = window.matchMedia(\"only screen and (max-width: 760px)\");\n\nlet thickness;\nif (isMobile.matches) {\n  thickness = two.height / 20\n  console.log('on mobile');\n} else {\n  thickness = two.width / 50\n  console.log('on computer');\n}\n\nthickness = two.height / 20\nconsole.log(thickness);\n\nlet background = two.makeRectangle(centerX, centerY, two.width, two.height)\nlet centerCircle = two.makeCircle(centerX, centerY,  centerRadius)\nlet smallCircle = two.makeEllipse(\n  centerX - centerRadius, centerY,\n  thickness * 0.4, thickness * 0.4\n)\nlet tick = two.makeRoundedRectangle(\n  centerX - centerRadius, centerY,\n  thickness / 2, thickness * 1.9, 3\n)\n\nbackground.fill = 'rgb(109, 140, 149)'\nbackground.noStroke()\n\ncenterCircle.noFill()\ncenterCircle.stroke = 'rgb(54, 60, 77)'\ncenterCircle.linewidth = thickness\n\nsmallCircle.fill = 'rgb(228, 142, 13)'\nsmallCircle.noStroke()\n\ntick.rotation = Math.PI / 2\ntick.noStroke()\ntick.fill = 'rgb(81, 191, 222)'\n\nlet highScore = 0\nlet tickAngle = 0\nlet points = 0\nlet randAngle = 2 * Math.PI * Math.random()\nlet direction = 1\nupdateScore()\n\ntwo.bind('update', function(frameCount) {\n  if (GAMERUNNING) {\n    updateGame()\n    updateAIWorker()\n  }\n}).play()\n\nlet ten = (10 * (Math.PI / 180)) // ten degrees in radians\n\n$(window).on('key-r', () => { document.getElementById('ai-button').onclick() })\n\n$(window).on('key-esc', () => { GAMERUNNING = !GAMERUNNING })\n\n$(window).on('key-space', () => {\n  if (tick.rotation > smallCircle.rotation - ten &&\n      tick.rotation < smallCircle.rotation + ten) {\n    direction *= -1\n    randAngle += Math.PI * Math.random()\n    randAngle %= 2 * Math.PI\n    points += 1\n  } else {\n    points = 0\n  }\n\n  updateScore()\n})\n\nlet prevMessageTime = 0\n\nfunction onAIMessage(event) {\n  // console.log('received message from AI worker')\n  // console.log(event.timeStamp - prevMessageTime > 350)\n  if (event.timeStamp - prevMessageTime > 350) {\n    // console.log(event.data);\n    $(window).trigger(event.data)\n    prevMessageTime = event.timeStamp\n  }\n}\n\nfunction updateAIWorker() {\n  if (AIPLAYING)\n    AIWORKER.postMessage([tick.rotation, smallCircle.rotation])\n}\n\nfunction updateGame() {\n  tickAngle += 0.05 * direction; tickAngle %= 2 * Math.PI\n\n  tick.translation.x = centerX + (centerRadius * Math.cos(tickAngle))\n  tick.translation.y = centerY + (centerRadius * Math.sin(tickAngle))\n  tick.rotation = (Math.PI / 2) + Math.atan2(\n    Math.sin(tickAngle),\n    Math.cos(tickAngle)\n  )\n\n  smallCircle.translation.x = centerX + (centerRadius * Math.cos(randAngle))\n  smallCircle.translation.y = centerY + (centerRadius * Math.sin(randAngle))\n  smallCircle.rotation = (Math.PI / 2) + Math.atan2(\n    Math.sin(randAngle),\n    Math.cos(randAngle)\n  )\n}\n\nfunction updateScore() {\n  highScore = (highScore > points ? highScore : points)\n  document.getElementById('high-score').innerHTML = 'High Score: ' + highScore\n  document.getElementById('score').innerHTML = points\n}\n\ndocument.getElementById('ai-button').onclick = function() {\n  AIPLAYING = !AIPLAYING\n\n  let button = document.getElementById('ai-button')\n  button.innerHTML = 'AI Player: ' + (AIPLAYING ? 'on' : 'off')\n  button.setAttribute('state', (AIPLAYING ? 'on' : 'off'))\n  button.blur()\n\n  if (AIPLAYING) {\n    AIWORKER = new Worker(\"./js/ai-player.js\");\n    AIWORKER.onmessage = onAIMessage\n\n  } else {\n    AIWORKER.terminate()\n    AIWORKER = null\n  }\n}\n"]}