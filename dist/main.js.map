{"version":3,"sources":["../js/main.js"],"names":[],"mappings":";;AAEA;;AAEA,IAAI,WAAW,OAAO,OAAO,WAAP,KAAuB,WAA9B;AACf,OAAO,WAAP,GAAqB,IAArB;AACA,OAAO,SAAP,GAAmB,KAAnB;AACA,OAAO,QAAP,GAAkB,IAAlB;;;AAGA,IAAI,OAAO,SAAS,cAAT,CAAwB,aAAxB,CAAP;AACJ,IAAI,SAAS,EAAE,OAAO,OAAO,UAAP,EAAmB,QAAQ,OAAO,WAAP,EAA7C;AACJ,IAAI,MAAM,IAAI,GAAJ,CAAQ,MAAR,EAAgB,QAAhB,CAAyB,IAAzB,CAAN;;AAEJ,IAAI,eAAe,IAAI,MAAJ,GAAa,CAAb;AACnB,IAAI,UAAU,IAAI,KAAJ,GAAY,CAAZ;AACd,IAAI,UAAU,IAAI,MAAJ,GAAa,CAAb;AACd,IAAI,YAAY,IAAI,MAAJ,GAAa,EAAb;;AAEhB,IAAI,aAAa,IAAI,aAAJ,CAAkB,OAAlB,EAA2B,OAA3B,EAAoC,IAAI,KAAJ,EAAW,IAAI,MAAJ,CAA5D;AACJ,IAAI,eAAe,IAAI,UAAJ,CAAe,OAAf,EAAwB,OAAxB,EAAkC,YAAlC,CAAf;AACJ,IAAI,cAAc,IAAI,WAAJ,CAChB,UAAU,YAAV,EAAwB,OADR,EAEhB,YAAY,GAAZ,EAAiB,YAAY,GAAZ,CAFf;AAIJ,IAAI,OAAO,IAAI,oBAAJ,CACT,UAAU,YAAV,EAAwB,OADf,EAET,YAAY,CAAZ,EAAe,YAAY,GAAZ,EAAiB,CAFvB,CAAP;;AAKJ,WAAW,IAAX,GAAkB,oBAAlB;AACA,WAAW,QAAX;;AAEA,aAAa,MAAb;AACA,aAAa,MAAb,GAAsB,iBAAtB;AACA,aAAa,SAAb,GAAyB,SAAzB;;AAEA,YAAY,IAAZ,GAAmB,mBAAnB;AACA,YAAY,QAAZ;;AAEA,KAAK,QAAL,GAAgB,KAAK,EAAL,GAAU,CAAV;AAChB,KAAK,QAAL;AACA,KAAK,IAAL,GAAY,mBAAZ;;AAEA,IAAI,YAAY,WAAW,UAAU,YAAV,CAAX,KAAuC,CAAvC;AAChB,IAAI,YAAY,CAAZ;AACJ,IAAI,SAAS,CAAT;AACJ,IAAI,YAAY,IAAI,KAAK,EAAL,GAAU,KAAK,MAAL,EAAd;AAChB,IAAI,YAAY,CAAZ;;AAEJ;;AAEA,IAAI,IAAJ,CAAS,QAAT,EAAmB,UAAS,UAAT,EAAqB;AACtC,MAAI,WAAJ,EAAiB;AACf,iBADe;AAEf,qBAFe;GAAjB;CADiB,CAAnB,CAKG,IALH;;AAOA,IAAI,MAAO,MAAM,KAAK,EAAL,GAAU,GAAV,CAAN;;AAEX,EAAE,MAAF,EAAU,EAAV,CAAa,OAAb,EAAsB,YAAM;AAAE,WAAS,cAAT,CAAwB,WAAxB,EAAqC,OAArC,GAAF;CAAN,CAAtB;;AAEA,EAAE,MAAF,EAAU,EAAV,CAAa,SAAb,EAAwB,YAAM;AAAE,gBAAc,CAAC,WAAD,CAAhB;CAAN,CAAxB;;AAEA,EAAE,MAAF,EAAU,EAAV,CAAa,WAAb,EAA0B,YAAM;AAC9B,MAAI,KAAK,QAAL,GAAgB,YAAY,QAAZ,GAAuB,GAAvB,IAChB,KAAK,QAAL,GAAgB,YAAY,QAAZ,GAAuB,GAAvB,EAA4B;AAC9C,iBAAa,CAAC,CAAD,CADiC;AAE9C,iBAAa,KAAK,EAAL,GAAU,KAAK,MAAL,EAAV,CAFiC;AAG9C,iBAAa,IAAI,KAAK,EAAL,CAH6B;AAI9C,cAAU,CAAV,CAJ8C;AAK9C,QAAK,KAAJ,CAAU,gCAAV,CAAD,CAA8C,IAA9C,GAL8C;GADhD,MAOO;AACL,aAAS,CAAT,CADK;GAPP;AAUA,gBAX8B;CAAN,CAA1B;;AAcA,IAAI,kBAAkB,CAAlB;;AAEJ,SAAS,WAAT,CAAqB,KAArB,EAA4B;AAC1B,MAAI,MAAM,SAAN,GAAkB,eAAlB,GAAoC,GAApC,EAAyC;AAC3C,MAAE,MAAF,EAAU,OAAV,CAAkB,MAAM,IAAN,CAAlB,CAD2C;AAE3C,sBAAkB,MAAM,SAAN,CAFyB;GAA7C;CADF;;AAOA,SAAS,cAAT,GAA0B;AACxB,MAAI,SAAJ,EACE,SAAS,WAAT,CAAqB,CAAC,KAAK,QAAL,EAAe,YAAY,QAAZ,CAArC,EADF;CADF;;AAKA,SAAS,UAAT,GAAsB;AACpB,MAAI,YAAY,SAAS,KAAT,CADI;AAEpB,eAAa,CAAC,OAAO,SAAP,CAAD,GAAqB,SAArB,CAFO,SAEyB,IAAa,IAAI,KAAK,EAAL,CAF1C;;AAIpB,OAAK,WAAL,CAAiB,CAAjB,GAAqB,UAAW,eAAe,KAAK,GAAL,CAAS,SAAT,CAAf,CAJZ;AAKpB,OAAK,WAAL,CAAiB,CAAjB,GAAqB,UAAW,eAAe,KAAK,GAAL,CAAS,SAAT,CAAf,CALZ;AAMpB,OAAK,QAAL,GAAgB,IAAC,CAAK,EAAL,GAAU,CAAV,GAAe,KAAK,KAAL,CAC9B,KAAK,GAAL,CAAS,SAAT,CAD8B,EAE9B,KAAK,GAAL,CAAS,SAAT,CAF8B,CAAhB,CANI;;AAWpB,cAAY,WAAZ,CAAwB,CAAxB,GAA4B,UAAW,eAAe,KAAK,GAAL,CAAS,SAAT,CAAf,CAXnB;AAYpB,cAAY,WAAZ,CAAwB,CAAxB,GAA4B,UAAW,eAAe,KAAK,GAAL,CAAS,SAAT,CAAf,CAZnB;AAapB,cAAY,QAAZ,GAAuB,IAAC,CAAK,EAAL,GAAU,CAAV,GAAe,KAAK,KAAL,CACrC,KAAK,GAAL,CAAS,SAAT,CADqC,EAErC,KAAK,GAAL,CAAS,SAAT,CAFqC,CAAhB,CAbH;CAAtB;;AAmBA,SAAS,WAAT,GAAuB;AACrB,cAAa,YAAY,MAAZ,GAAqB,SAArB,GAAiC,MAAjC,CADQ;AAErB,WAAS,cAAT,CAAwB,YAAxB,EAAsC,SAAtC,GAAkD,iBAAiB,SAAjB,CAF7B;AAGrB,WAAS,cAAT,CAAwB,OAAxB,EAAiC,SAAjC,GAA6C,MAA7C,CAHqB;AAIrB,YAAU,YAAV,EAAwB,SAAxB,EAAmC,MAAnC,EAJqB;AAKrB,MAAI,eAAe,SAAS,cAAT,CAAwB,cAAxB,CAAf,CALiB;AAMrB,MAAI,WAAW,CAAX,EAAa;AACf,iBAAa,SAAb,IAA6B,WAAW,cAAX,GAA4B,oBAA5B,eAA7B,CADe;AAEf,wBAFe;GAAjB,MAIK;AACH,iBAAa,SAAb,GAAyB,EAAzB,CADG;AAEH,MAAE,wBAAF,EAA4B,QAA5B,CAAqC,WAArC,EAFG;GAJL;CANF;;AAgBA,SAAS,iBAAT,GAA6B;AAC3B,kBACG,IADH,CACQ,UAAC,IAAD,EAAU;AACd,MAAE,mBAAF,EAAuB,WAAvB,kHADc;AAQd,QAAI,SAAS,KAAK,MAAL,CARC;AASd,SAAK,IAAI,CAAJ,IAAS,MAAd,EAAsB;AACpB,QAAE,2BAAF,EAA+B,KAA/B,cAAgD,OAAO,CAAP,EAAU,IAAV,iBAA0B,OAAO,CAAP,EAAU,KAAV,eAA1E,EADoB;KAAtB;AAGA,MAAE,wBAAF,EAA4B,WAA5B,CAAwC,WAAxC,EAZc;GAAV,CADR,CAD2B;CAA7B;;AAkBA,SAAS,cAAT,CAAwB,WAAxB,EAAqC,OAArC,GAA+C,YAAW;AACxD,cAAY,CAAC,SAAD,CAD4C;;AAGxD,MAAI,SAAS,SAAS,cAAT,CAAwB,WAAxB,CAAT,CAHoD;AAIxD,SAAO,SAAP,GAAmB,iBAAiB,YAAY,IAAZ,GAAmB,KAAnB,CAAjB,CAJqC;AAKxD,SAAO,YAAP,CAAoB,OAApB,EAA8B,YAAY,IAAZ,GAAmB,KAAnB,CAA9B,CALwD;AAMxD,SAAO,IAAP,GANwD;;AAQxD,MAAI,SAAJ,EAAe;AACb,eAAW,IAAI,MAAJ,CAAW,mBAAX,CAAX,CADa;AAEb,aAAS,SAAT,GAAqB,WAArB,CAFa;GAAf,MAIO;AACL,aAAS,SAAT,GADK;AAEL,eAAW,IAAX,CAFK;GAJP;CAR6C;;;AAmB/C,SAAS,SAAT,CAAmB,KAAnB,EAA0B,MAA1B,EAAkC,MAAlC,EAA0C;AACtC,MAAI,IAAI,IAAI,IAAJ,EAAJ,CADkC;AAEtC,IAAE,OAAF,CAAU,EAAE,OAAF,KAAe,SAAO,EAAP,GAAU,EAAV,GAAa,EAAb,GAAgB,IAAhB,CAAzB,CAFsC;AAGtC,MAAI,UAAU,aAAW,EAAE,WAAF,EAAX,CAHwB;AAItC,WAAS,MAAT,GAAkB,QAAQ,GAAR,GAAc,MAAd,GAAuB,IAAvB,GAA8B,OAA9B,CAJoB;CAA1C;;AAOA,SAAS,SAAT,CAAmB,KAAnB,EAA0B;AACtB,MAAI,OAAO,QAAQ,GAAR,CADW;AAEtB,MAAI,KAAK,SAAS,MAAT,CAAgB,KAAhB,CAAsB,GAAtB,CAAL,CAFkB;AAGtB,OAAI,IAAI,IAAI,CAAJ,EAAO,IAAE,GAAG,MAAH,EAAW,GAA5B,EAAiC;AAC7B,QAAI,IAAI,GAAG,CAAH,CAAJ,CADyB;AAE7B,WAAO,EAAE,MAAF,CAAS,CAAT,MAAgB,GAAhB;AAAqB,UAAI,EAAE,SAAF,CAAY,CAAZ,CAAJ;KAA5B,IACI,EAAE,OAAF,CAAU,IAAV,MAAoB,CAApB,EAAuB,OAAO,EAAE,SAAF,CAAY,KAAK,MAAL,EAAY,EAAE,MAAF,CAA/B,CAA3B;GAHJ;AAKA,SAAO,EAAP,CARsB;CAA1B","file":"main.js","sourcesContent":["//jshint -W117\n//jshint -W097\n'use strict';\n\nlet isMobile = typeof window.orientation !== 'undefined'\nwindow.GAMERUNNING = true\nwindow.AIPLAYING = false\nwindow.AIWORKER = null\n\n// Make an instance of two and place it on the page.\nlet elem = document.getElementById('draw-shapes')\nlet params = { width: window.innerWidth, height: window.innerHeight }\nlet two = new Two(params).appendTo(elem)\n\nlet centerRadius = two.height / 8\nlet centerX = two.width / 2\nlet centerY = two.height / 2\nlet thickness = two.height / 20\n\nlet background = two.makeRectangle(centerX, centerY, two.width, two.height)\nlet centerCircle = two.makeCircle(centerX, centerY,  centerRadius)\nlet smallCircle = two.makeEllipse(\n  centerX - centerRadius, centerY,\n  thickness * 0.4, thickness * 0.4\n)\nlet tick = two.makeRoundedRectangle(\n  centerX - centerRadius, centerY,\n  thickness / 2, thickness * 1.9, 3\n)\n\nbackground.fill = 'rgb(109, 140, 149)'\nbackground.noStroke()\n\ncenterCircle.noFill()\ncenterCircle.stroke = 'rgb(54, 60, 77)'\ncenterCircle.linewidth = thickness\n\nsmallCircle.fill = 'rgb(228, 142, 13)'\nsmallCircle.noStroke()\n\ntick.rotation = Math.PI / 2\ntick.noStroke()\ntick.fill = 'rgb(81, 191, 222)'\n\nlet highScore = parseFloat(getCookie('highScore2')) || 0\nlet tickAngle = 0\nlet points = 0\nlet randAngle = 2 * Math.PI * Math.random()\nlet direction = 1\n\nupdateScore()\n\ntwo.bind('update', function(frameCount) {\n  if (GAMERUNNING) {\n    updateGame()\n    updateAIWorker()\n  }\n}).play()\n\nlet ten = (10 * (Math.PI / 180)) // ten degrees in radians\n\n$(window).on('key-r', () => { document.getElementById('ai-button').onclick() })\n\n$(window).on('key-esc', () => { GAMERUNNING = !GAMERUNNING })\n\n$(window).on('key-space', () => {\n  if (tick.rotation > smallCircle.rotation - ten &&\n      tick.rotation < smallCircle.rotation + ten) {\n    direction *= -1\n    randAngle += Math.PI * Math.random()\n    randAngle %= 2 * Math.PI\n    points += 1;\n    (new Audio('./asset/blop-mark-diangelo.mp3')).play()\n  } else {\n    points = 0\n  }\n  updateScore()\n})\n\nlet prevMessageTime = 0\n\nfunction onAIMessage(event) {\n  if (event.timeStamp - prevMessageTime > 350) {\n    $(window).trigger(event.data)\n    prevMessageTime = event.timeStamp\n  }\n}\n\nfunction updateAIWorker() {\n  if (AIPLAYING)\n    AIWORKER.postMessage([tick.rotation, smallCircle.rotation])\n}\n\nfunction updateGame() {\n  let tickSpeed = points * 0.001\n  tickAngle += (0.05 + tickSpeed) * direction; tickAngle %= 2 * Math.PI\n\n  tick.translation.x = centerX + (centerRadius * Math.cos(tickAngle))\n  tick.translation.y = centerY + (centerRadius * Math.sin(tickAngle))\n  tick.rotation = (Math.PI / 2) + Math.atan2(\n    Math.sin(tickAngle),\n    Math.cos(tickAngle)\n  )\n\n  smallCircle.translation.x = centerX + (centerRadius * Math.cos(randAngle))\n  smallCircle.translation.y = centerY + (centerRadius * Math.sin(randAngle))\n  smallCircle.rotation = (Math.PI / 2) + Math.atan2(\n    Math.sin(randAngle),\n    Math.cos(randAngle)\n  )\n}\n\nfunction updateScore() {\n  highScore = (highScore > points ? highScore : points)\n  document.getElementById('high-score').innerHTML = 'High Score: ' + highScore\n  document.getElementById('score').innerHTML = points\n  setCookie('highScore2', highScore, 999999)\n  let instructions = document.getElementById('instructions')\n  if (points === 0){\n    instructions.innerHTML = `${ isMobile ? 'tap anywhere' : 'press the spacebar'} to begin`\n    displayHighScores()\n  }\n  else {\n    instructions.innerHTML = ''\n    $('#scores-list-container').addClass('invisible')\n  }\n}\n\nfunction displayHighScores() {\n  getHighScores()\n    .then((data) => {\n      $('#high-score-table').replaceWith(\n        `<table id=\"high-score-table\">\n          <tbody>\n            <tr></tr>\n          </tbody>\n        </table>`\n      )\n      let result = data.result\n      for (let i in result) {\n        $('#high-score-table tr:last').after(`<tr><td>${result[i].name}</td><td>${result[i].score}</td></tr>`)\n      }\n      $('#scores-list-container').removeClass('invisible')\n    })\n}\n\ndocument.getElementById('ai-button').onclick = function() {\n  AIPLAYING = !AIPLAYING\n\n  let button = document.getElementById('ai-button')\n  button.innerHTML = 'AI Player: ' + (AIPLAYING ? 'on' : 'off')\n  button.setAttribute('state', (AIPLAYING ? 'on' : 'off'))\n  button.blur()\n\n  if (AIPLAYING) {\n    AIWORKER = new Worker(\"./js/ai-player.js\");\n    AIWORKER.onmessage = onAIMessage\n\n  } else {\n    AIWORKER.terminate()\n    AIWORKER = null\n  }\n}\n\n// http://www.w3schools.com/js/js_cookies.asp\nfunction setCookie(cname, cvalue, exdays) {\n    var d = new Date();\n    d.setTime(d.getTime() + (exdays*24*60*60*1000));\n    var expires = \"expires=\"+d.toUTCString();\n    document.cookie = cname + \"=\" + cvalue + \"; \" + expires;\n}\n\nfunction getCookie(cname) {\n    var name = cname + \"=\";\n    var ca = document.cookie.split(';');\n    for(var i = 0; i<ca.length; i++) {\n        var c = ca[i];\n        while (c.charAt(0) === ' ') c = c.substring(1);\n        if (c.indexOf(name) === 0) return c.substring(name.length,c.length);\n    }\n    return \"\";\n}\n\n// displayHighScores()\n// $('#high-score-table tr:last').after('<tr><td>Name</td><td>Score</td></tr>')\n"]}